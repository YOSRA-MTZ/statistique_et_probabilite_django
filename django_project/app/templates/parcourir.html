{% load static %}
<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Parcourir les données</title>
    {% block styles %}
        <link rel="stylesheet" type="text/css" href="{% static 'css/visualiser.css' %}">
        <link href="{% static 'webfonts/all.min.css' %}" rel="stylesheet">
    {% endblock %}
</head>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

<body>
    <div class="card1">
        <h2>Formulaire </h2>
        <form method="post" action="{% url 'parcourir_chart' %}" enctype="multipart/form-data">
            {% csrf_token %}

            <select id="parcourir_chart" name="parcourir_chart">
                <option value="Nothing">-</option>
                <option value="FindElem">FindElem</option>
                <option value="Slicing">Slicing</option>
                <option value="GroupBy">GroupBy</option>
            </select>

            <select id="col_name1" name="col_name1">
                {% for col in column_names %}
                    <option>{{ col }}</option>
                {% endfor %}
            </select>

            <input type="number" placeholder="Le numero de la ligne :" id="RowNumb" name="RowNumb" min="0" max="{{ max_row }}" step="1">

            <select id="parcourir_rows" name="parcourir_rows">
                <option value="Nothing">Browse rows</option>
                <option value="NbrOfRowsTop">Number of rows from the top </option>
                <option value="NbrOfRowsBottom">Number of rows from the bottom</option>
                <option value="FromRowToRow">From x row to y row</option>
            </select>

            <input type="number" placeholder="Number of rows starting from the Top" id="Head" name="Head" min="0" max="{{ max_row }}" step="1">

            <input type="number" placeholder="Number of rows starting from the Bottom" id="Tail" name="Tail" min="0" max="{{ max_row }}" step="1">

            <input type="number" placeholder="From row number " id="FromRowNumb" name="FromRowNumb" min="0" max="{{ max_row }}" step="1">

            <input type="number" placeholder="To the row number " id="ToRowNumb" name="ToRowNumb" min="0" max="{{ max_row }}" step="1">

            

            {% for col in column_names %}
                <div class="form-check form-check-inline" id="colonne">
                    <input
                        class="form-check-input"
                        type="checkbox"
                        name="selected_columns"
                        value="{{ col }}"
                        id="{{ col }}"
                    />
                    <label class="form-check-label" for="{{ col }}">
                        {{ col }}
                    </label>
                </div>
            {% endfor %}


            <button type="submit">Envoyer</button>
        </form>
    </div>

   


    <div class="card">
        {% if df %}
            <h3>Résultats de la recherche :</h3>
            <div style="overflow-x: auto; overflow-y: auto; height: 550px;">
                <table>
                    {{ df|safe }}
                </table>
            </div>
        {% endif %}
    </div>
    
    <div class="specific-search-result">
        {% if resultat is not None %}
            <h3>Résultat de la recherche spécifique :</h3>
            <p>Valeur pour la colonne {{ col_name1 }} à la ligne {{ RowNumb }} : {{ resultat }}</p>
        {% endif %}
    </div>


    <script>
        $(document).ready(function(){
            // Cacher les listes déroulantes au chargement initial de la page
            $('#col_name1, #RowNumb ,#parcourir_rows ,#Head, #Tail ,#FromRowNumb,#ToRowNumb ,#colonne').hide();

            $('#parcourir_chart').change(function(){
                var selected_chart = $(this).val();
                console.log(selected_chart);  // Vérifier la valeur sélectionnée dans la console
                
                if (selected_chart === 'FindElem') {
                    $('#col_name1, #RowNumb ,#parcourir_rows ,#Head, #Tail ,#FromRowNumb,#ToRowNumb ,#colonne').hide();
                    $('#col_name1, #RowNumb').show(); 
                    

                } else if (selected_chart === 'Slicing') {
                    $('#col_name1, #RowNumb ,#parcourir_rows ,#Head, #Tail ,#FromRowNumb,#ToRowNumb ,#colonne').hide();
                    $('#parcourir_rows').show();

                    $('#parcourir_rows').change(function(){
                        var selected_chart_rows = $(this).val();
                        console.log(selected_chart_rows); 
                        if (selected_chart_rows === 'NbrOfRowsTop') {
                            $('#col_name1, #RowNumb ,#parcourir_rows ,#Head, #Tail ,#FromRowNumb,#ToRowNumb ,#colonne').hide();
                            $('#Head ,#colonne').show();
                            
                        } else if (selected_chart_rows === 'NbrOfRowsBottom') {
                            $('#col_name1, #RowNumb ,#parcourir_rows ,#Head, #Tail ,#FromRowNumb,#ToRowNumb ,#colonne').hide();
                            $('#Tail , #colonne').show();
                        }else if (selected_chart_rows === 'FromRowToRow') {
                            $('#col_name1, #RowNumb ,#parcourir_rows ,#Head, #Tail ,#FromRowNumb,#ToRowNumb ,#colonne').hide();
                            $('#FromRowNumb,#ToRowNumb , #colonne').show();
                        }
                        
                    });
                    

                } else if (selected_chart === 'GroupBy') {
                    // Si aucune sélection n'est faite ou si la sélection est par défaut
                    $('#col_name1, #RowNumb ,#parcourir_rows ,#Head, #Tail ,#FromRowNumb,#ToRowNumb').hide();  // Cacher les deux listes déroulantes
                }
            });
        });
        
        
        
    </script>
    





</body>
</html>
